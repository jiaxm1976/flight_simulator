# 🎯 阶段0：任务清单与详细指导

## 📋 阶段0概览

**目标：** 掌握Babylon.js基础，显示一个飞机模型在3D场景中

**时间：** 15-20天（每天30分钟）

**完成标准：**
- ✅ 能显示3D场景（天空+地面）
- ✅ 能显示飞机模型（或用形状拼接）
- ✅ 相机能跟随飞机视角
- ✅ 理解3D坐标系（X/Y/Z轴）

---

## 📅 任务列表

| 任务 | 内容 | 预计时间 | 状态 |
|------|------|----------|------|
| **任务1** | 创建基础HTML文件，显示立方体 | 30分钟 | ⬜ |
| **任务2** | 添加地面和天空 | 30分钟 | ⬜ |
| **任务3** | 理解3D坐标系，移动立方体 | 30分钟 | ⬜ |
| **任务4** | 学习向量基础 | 30分钟 | ⬜ |
| **任务5** | 学习旋转（欧拉角） | 30分钟 | ⬜ |
| **任务6** | 用基础形状拼接简单飞机 | 30-60分钟 | ⬜ |
| **任务7** | 相机跟随飞机 | 30分钟 | ⬜ |
| **任务8** | 优化场景（添加雾效、调整光照） | 30分钟 | ⬜ |
| **任务9-10** | （可选）加载外部3D模型 | 60分钟 | ⬜ |

---

## 📝 任务1：创建基础HTML文件，显示立方体

### 🎯 任务目标
创建第一个HTML文件，使用Babylon.js显示一个立方体

### ⏱️ 预计时间
30分钟

### 📖 完整代码（超详细注释版）

创建文件：`index.html`

```html
<!--
==============================================
项目：Flight Simulator（飞行模拟器）
开发者：Risen
文件：index.html
功能：项目入口文件，初始化3D场景并显示立方体
创建日期：2025-12-13
最后修改：2025-12-13
==============================================
-->

<!--
==============================================
HTML文档声明与基本结构
==============================================
-->

<!--
    DOCTYPE声明：告诉浏览器这是HTML5文档
    必须放在文件的第一行
-->
<!DOCTYPE html>

<!--
    <html>标签：HTML文档的根元素
    所有其他标签都必须在<html>和</html>之间
-->
<html>

<!--
==============================================
<head>部分：网页的头部信息
这部分内容不会直接显示在页面上
==============================================
-->
<head>
    <!--
        <meta>标签：网页的元信息
        charset="UTF-8"：字符编码设置为UTF-8
        作用：支持中文、日文等多语言字符
    -->
    <meta charset="UTF-8">

    <!--
        <meta>标签：视口设置（移动端适配）
        viewport：视口
        width=device-width：宽度等于设备宽度
        initial-scale=1.0：初始缩放比例为1（不缩放）
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--
        <title>标签：网页标题
        显示在浏览器的标签页上
        不显示在页面内容中
    -->
    <title>飞行模拟器 - 任务1</title>

    <!--
        <style>标签：CSS样式代码
        用于控制页面元素的外观
    -->
    <style>
        /*
        ==============================================
        CSS注释的写法：/* 内容 */
        和HTML注释 <!-- --> 不同
        ==============================================
        */

        /*
            body选择器：选中<body>标签
            { }：花括号内是样式规则
        */
        body {
            margin: 0;              /* margin：外边距，0表示没有外边距 */
            padding: 0;             /* padding：内边距，0表示没有内边距 */
            overflow: hidden;       /* overflow：溢出处理，hidden表示隐藏滚动条 */
            font-family: Arial, sans-serif;  /* font-family：字体 */
        }

        /*
            #renderCanvas：ID选择器
            #：表示选中id="renderCanvas"的元素
        */
        #renderCanvas {
            width: 100%;            /* width：宽度，100%表示占满父元素的宽度 */
            height: 100vh;          /* height：高度，100vh表示占满视口高度 */
                                    /* vh是单位，viewport height（视口高度） */
                                    /* 100vh = 浏览器窗口的100%高度 */
            display: block;         /* display：显示方式，block表示块级元素 */
                                    /* 块级元素会独占一行 */
        }

        /*
            信息显示区域的样式（用于调试）
        */
        #info {
            position: absolute;     /* position：定位方式，absolute表示绝对定位 */
            top: 10px;              /* top：距离顶部10像素 */
            left: 10px;             /* left：距离左侧10像素 */
            color: white;           /* color：文字颜色，白色 */
            font-size: 14px;        /* font-size：字体大小，14像素 */
            background: rgba(0,0,0,0.5);  /* background：背景色 */
                                          /* rgba：红绿蓝+透明度 */
                                          /* (0,0,0,0.5)：黑色，50%透明 */
            padding: 10px;          /* padding：内边距10像素 */
            border-radius: 5px;     /* border-radius：圆角半径5像素 */
        }
    </style>

    <!--
        <script>标签：引入外部JavaScript库
        src="..."：从这个网址加载Babylon.js库
        CDN：Content Delivery Network，内容分发网络
        作用：从互联网加载Babylon.js，无需手动下载
    -->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
</head>

<!--
==============================================
<body>部分：网页的主体内容
这部分会显示在浏览器窗口中
==============================================
-->
<body>
    <!--
        <canvas>标签：画布元素
        Babylon.js会在这个画布上绘制3D图形
        id="renderCanvas"：给元素一个唯一的ID
        作用：JavaScript可以通过这个ID找到这个元素
    -->
    <canvas id="renderCanvas"></canvas>

    <!--
        <div>标签：容器标签，用于组织内容
        id="info"：ID为info，对应上面CSS中的#info样式
        作用：显示调试信息
    -->
    <div id="info">
        任务1：显示立方体<br>
        <!-- <br>标签：换行标签 -->
        鼠标拖动：旋转视角<br>
        滚轮：缩放
    </div>

    <!--
        第二个<script>标签：我们自己写的JavaScript代码
        这里不用src属性，直接在标签内写代码
        建议放在</body>之前，确保页面元素已加载
    -->
    <script>
        // ====================================================================
        // JavaScript注释的写法：
        // 单行注释：// 内容
        // 多行注释：/* 内容 */
        // ====================================================================

        // ====================================================================
        // 第1步：获取canvas元素
        // ====================================================================

        // const：关键字，声明一个常量（constant）
        //        常量：值不会改变的变量
        // canvas：变量名，我们给它起的名字（可以自定义）
        // =：赋值运算符，把右边的值赋给左边的变量
        // document：内置对象，代表整个HTML文档
        // .：点号，用于访问对象的属性或方法
        // getElementById：方法，通过ID查找元素
        //                 get = 获取，Element = 元素，ById = 通过ID
        // ("renderCanvas")：参数，要查找的ID名称
        //                   必须用引号括起来（字符串）
        //                   必须和HTML中的id="renderCanvas"一致
        // ;：分号，JavaScript语句的结束符（可选，但建议加上）
        const canvas = document.getElementById("renderCanvas");

        // 验证是否成功获取
        // console.log：在浏览器控制台输出信息
        // 按F12打开浏览器控制台可以看到
        console.log("Canvas元素:", canvas);

        // ====================================================================
        // 第2步：创建Babylon.js渲染引擎
        // ====================================================================

        // new：关键字，创建一个新对象（实例化）
        // BABYLON：Babylon.js库的命名空间
        //          所有Babylon.js的功能都在BABYLON对象下
        // Engine：引擎类（Class），负责渲染3D图形
        // 参数说明：
        //   第1个参数：canvas - 要渲染到哪个画布
        //   第2个参数：true - 是否启用抗锯齿（antialiasing）
        //              true = 启用，图像更平滑但性能稍差
        //              false = 不启用，性能更好但可能有锯齿
        const engine = new BABYLON.Engine(canvas, true);

        console.log("引擎创建成功:", engine);

        // ====================================================================
        // 第3步：创建场景
        // ====================================================================

        // 为什么要用函数？
        // 把创建场景的代码封装在函数里，代码更清晰
        // 以后可以重复调用这个函数

        // function：关键字，声明一个函数
        // createScene：函数名，我们给它起的名字
        // ()：参数列表，这个函数没有参数，所以是空的
        // { }：花括号，函数体，里面是函数要执行的代码
        const createScene = function() {

            // ================================================================
            // 3.1 创建场景对象
            // ================================================================

            // Scene：场景类，是所有3D物体的容器
            //        想象成一个虚拟的3D空间
            // (engine)：参数，把引擎传给场景
            //           场景需要知道用哪个引擎来渲染
            const scene = new BABYLON.Scene(engine);

            console.log("场景创建成功:", scene);

            // ================================================================
            // 3.2 设置场景背景色
            // ================================================================

            // clearColor：场景的背景颜色属性
            // Color3：颜色类，表示RGB颜色
            //         R = Red（红色）
            //         G = Green（绿色）
            //         B = Blue（蓝色）
            // (0.5, 0.7, 1.0)：RGB值
            //   取值范围：0-1（不是0-255！）
            //   0 = 没有这个颜色分量
            //   1 = 这个颜色分量最大
            //   计算方法：如果你有0-255的值，除以255即可
            //   例如：RGB(128, 179, 255) -> (128/255, 179/255, 255/255)
            //
            // 当前值分析：
            //   0.5：红色分量 50%
            //   0.7：绿色分量 70%
            //   1.0：蓝色分量 100%
            //   混合结果：淡蓝色（天空的颜色）
            scene.clearColor = new BABYLON.Color3(0.5, 0.7, 1.0);

            // ================================================================
            // 3.3 创建相机（观察视角）
            // ================================================================

            // 为什么需要相机？
            // 3D世界需要一个"观察点"，就像你的眼睛
            // 没有相机，即使创建了物体，也看不到

            // ArcRotateCamera：弧形旋转相机
            //                  可以围绕目标点旋转，适合查看物体
            //                  Arc = 弧形，Rotate = 旋转
            //
            // 参数详解：
            const camera = new BABYLON.ArcRotateCamera(
                "camera",                   // 第1个参数：相机的名称（字符串）
                                            //   名称可以随便起，用于识别这个相机

                0,                          // 第2个参数：Alpha角（水平旋转角度）
                                            //   单位：弧度（radians）
                                            //   0 = 从正前方看
                                            //   Math.PI/2 = 从右侧看
                                            //   Math.PI = 从正后方看

                Math.PI / 3,                // 第3个参数：Beta角（垂直旋转角度）
                                            //   单位：弧度
                                            //   Math.PI = 圆周率π ≈ 3.14159
                                            //   π/3 ≈ 1.047 弧度 ≈ 60度
                                            //   0 = 从正上方俯视
                                            //   π/2 = 水平观看
                                            //   π = 从正下方仰视

                10,                         // 第4个参数：Radius（半径）
                                            //   相机距离目标点的距离
                                            //   单位：场景单位（可以理解为米）
                                            //   10 = 距离目标点10个单位

                BABYLON.Vector3.Zero(),     // 第5个参数：相机看向的目标点
                                            //   Vector3：三维向量（x, y, z）
                                            //   Zero()：返回(0, 0, 0)
                                            //   (0, 0, 0)是3D空间的原点

                scene                       // 第6个参数：所属的场景对象
            );

            // 让相机响应用户操作
            // attachControl：附加控制
            //   attach = 附加，Control = 控制
            // 参数：
            //   第1个：canvas - 监听哪个画布上的鼠标事件
            //   第2个：true - 是否阻止浏览器默认行为
            //          true = 阻止（例如右键菜单不会弹出）
            camera.attachControl(canvas, true);

            console.log("相机创建成功:", camera);

            // ================================================================
            // 3.4 创建光源（照亮物体）
            // ================================================================

            // 为什么需要光源？
            // 3D物体需要光照才能看见
            // 就像现实世界，没有光就是一片黑暗

            // HemisphericLight：半球光
            //   Hemispheric = 半球的
            //   模拟天空的环境光，柔和自然
            //
            // 参数详解：
            const light = new BABYLON.HemisphericLight(
                "light",                        // 第1个参数：光源名称

                new BABYLON.Vector3(0, 1, 0),   // 第2个参数：光的方向
                                                 //   Vector3(x, y, z)
                                                 //   (0, 1, 0)表示Y轴正方向
                                                 //   即从上往下照射
                                                 //
                                                 //   3D坐标系：
                                                 //   X轴：左右（负=左，正=右）
                                                 //   Y轴：上下（负=下，正=上）
                                                 //   Z轴：前后（负=后，正=前）

                scene                           // 第3个参数：所属场景
            );

            // 可选：调整光照强度
            // intensity：强度
            //   范围：0-1（0=无光，1=最亮）
            //   默认值：1
            // light.intensity = 0.7;  // 70%亮度

            console.log("光源创建成功:", light);

            // ================================================================
            // 3.5 创建立方体（第一个3D物体！）
            // ================================================================

            // MeshBuilder：网格构建器
            //   Mesh = 网格（3D模型的基本单位）
            //   Builder = 构建器
            //   提供各种创建3D形状的方法
            //
            // CreateBox：创建立方体方法
            //   Create = 创建，Box = 立方体
            //
            // 参数详解：
            const box = BABYLON.MeshBuilder.CreateBox(
                "box",                      // 第1个参数：立方体的名称

                { size: 2 },                // 第2个参数：选项对象（options）
                                            //   { }：对象的写法，包含键值对
                                            //   size: 2：边长为2个单位
                                            //
                                            //   其他可选属性：
                                            //   width：宽度（X轴）
                                            //   height：高度（Y轴）
                                            //   depth：深度（Z轴）
                                            //   如果只写size，则三个方向都是这个值

                scene                       // 第3个参数：所属场景
            );

            // 可选：设置立方体的位置
            // position：位置属性，是一个Vector3对象
            // box.position.x = 0;  // X轴位置（左右）
            // box.position.y = 1;  // Y轴位置（上下），1表示在地面上方1个单位
            // box.position.z = 0;  // Z轴位置（前后）

            console.log("立方体创建成功:", box);

            // ================================================================
            // 3.6 返回场景对象
            // ================================================================

            // return：关键字，函数返回值
            //   把场景对象返回给调用者
            //   调用createScene()函数会得到这个scene对象
            return scene;

        }; // 函数定义结束

        // ====================================================================
        // 第4步：调用函数，创建场景
        // ====================================================================

        // createScene()：调用函数
        //   函数名后面加()表示执行这个函数
        //   这个函数会返回scene对象
        // const scene = ...：把返回的scene对象赋值给变量scene
        //   这样我们就可以在后面的代码中使用scene变量
        const scene = createScene();

        console.log("场景已创建并赋值:", scene);

        // ====================================================================
        // 第5步：启动渲染循环（让画面动起来）
        // ====================================================================

        // 什么是渲染循环？
        // 渲染：把3D场景画到屏幕上
        // 循环：不停重复执行
        // 目的：持续更新画面，达到动画效果
        //      就像电影是由每秒24帧画面组成的
        //      游戏通常是每秒60帧

        // runRenderLoop：引擎的渲染循环方法
        //   run = 运行，Render = 渲染，Loop = 循环
        //
        // 参数：一个函数
        //   这个函数会被重复调用，通常每秒约60次
        //   这里使用匿名函数（没有名字的函数）
        engine.runRenderLoop(function() {
            // 这里的代码会每帧执行一次

            // scene.render()：渲染场景
            //   把3D场景画到canvas画布上
            //   每调用一次，就画一帧
            scene.render();
        });

        console.log("渲染循环已启动");

        // ====================================================================
        // 第6步：窗口大小改变时的处理
        // ====================================================================

        // 为什么需要这个？
        // 当用户调整浏览器窗口大小时
        // canvas需要重新调整，否则3D画面会变形或裁剪

        // window：浏览器窗口对象
        //   代表整个浏览器窗口
        // addEventListener：添加事件监听器方法
        //   add = 添加，Event = 事件，Listener = 监听器
        //
        // 参数：
        //   第1个："resize" - 事件类型
        //          resize = 调整大小
        //          当窗口大小改变时触发
        //   第2个：function() {...} - 事件处理函数
        //          当事件发生时，执行这个函数
        window.addEventListener("resize", function() {
            // 当用户调整浏览器窗口大小时
            // 这里的代码会执行

            // engine.resize()：重新调整引擎的渲染大小
            //   resize = 调整大小
            //   让引擎适应新的窗口大小
            engine.resize();

            console.log("窗口大小已改变，引擎已调整");
        });

        // ====================================================================
        // 代码结束
        // ====================================================================

        console.log("初始化完成！");
        console.log("提示：按F12打开控制台查看更多信息");

    </script>

</body>
<!-- <body>标签结束 -->

</html>
<!-- <html>标签结束，整个HTML文档结束 -->
```

### 🚀 运行方法

1. **创建文件：**
   - 打开记事本（或任何文本编辑器）
   - 复制上面的完整代码
   - 保存为：`index.html`
   - 保存位置：`C:\Users\Administrator\Risen-work\flight-simulator\index.html`

2. **运行文件：**
   - 找到保存的 `index.html` 文件
   - 双击打开（会在浏览器中运行）

3. **预期效果：**
   - 看到淡蓝色的背景
   - 中央有一个灰色的立方体
   - 左上角有白色的提示文字

4. **交互操作：**
   - **鼠标左键拖动**：旋转视角
   - **滚轮**：缩放（拉近/推远）
   - **鼠标右键拖动**：平移视角

### ✅ 检查清单

完成后，检查以下项目：

- [ ] 文件保存为 `index.html`
- [ ] 双击能在浏览器中打开
- [ ] 看到淡蓝色背景
- [ ] 看到灰色立方体
- [ ] 看到左上角的提示文字
- [ ] 鼠标能拖动旋转视角
- [ ] 滚轮能缩放
- [ ] 按F12打开控制台，没有红色错误信息

### ❓ 常见问题

**Q1: 双击文件没有反应？**
- 检查文件扩展名是否是 `.html`（不是 `.txt`）
- 右键文件 → 打开方式 → 选择浏览器（Chrome/Edge/Firefox）

**Q2: 页面是空白的？**
- 按F12打开控制台，查看是否有错误信息
- 检查是否联网（需要从CDN加载Babylon.js）
- 检查代码是否完整复制

**Q3: 看到立方体，但不能拖动？**
- 检查 `camera.attachControl(canvas, true);` 这行代码是否存在
- 尝试刷新页面（F5）

**Q4: 控制台有红色错误？**
- 复制错误信息，询问我
- 常见错误：
  - `BABYLON is not defined` → CDN加载失败，检查网络
  - `Cannot read property of null` → ID拼写错误

### 🎯 下一步

完成任务1后，继续：
- ✅ 任务2：添加地面和天空

---

## 📝 任务2：添加地面和天空

### 🎯 任务目标
在现有场景中添加地面和天空，让场景更真实

### ⏱️ 预计时间
30分钟

### 📝 代码修改

打开 `index.html`，找到 `createScene` 函数中创建立方体的代码（`const box = ...` 那一段），在它**后面**添加以下代码：

```javascript
// ================================================================
// 3.6 创建地面
// ================================================================

// CreateGround：创建地面方法
//   Ground = 地面
//
// 参数详解：
const ground = BABYLON.MeshBuilder.CreateGround(
    "ground",                   // 第1个参数：地面的名称

    {                           // 第2个参数：选项对象
        width: 100,             //   width：宽度（X轴方向）
                                //   100个单位，很大的地面

        height: 100             //   height：深度（Z轴方向）
                                //   注意：这里的height实际是Z轴的长度
                                //   有点反直觉，但Babylon.js就是这样设计的
    },

    scene                       // 第3个参数：所属场景
);

// 设置地面的材质（Material）
// 材质决定物体的外观（颜色、纹理等）

// 创建标准材质
// StandardMaterial：标准材质类
const groundMaterial = new BABYLON.StandardMaterial("groundMat", scene);
//   第1个参数：材质名称
//   第2个参数：所属场景

// 设置材质的漫反射颜色（diffuseColor）
// diffuse = 漫反射，物体表面的主要颜色
// 这里设置为绿色（草地的颜色）
groundMaterial.diffuseColor = new BABYLON.Color3(0.2, 0.6, 0.2);
//   (0.2, 0.6, 0.2) = 暗绿色
//   R=0.2（20%红色）
//   G=0.6（60%绿色）
//   B=0.2（20%蓝色）

// 把材质应用到地面
// material：网格的材质属性
ground.material = groundMaterial;

console.log("地面创建成功:", ground);

// ================================================================
// 3.7 创建天空盒（Skybox）
// ================================================================

// 什么是天空盒？
// 一个巨大的立方体，把整个场景包裹起来
// 在立方体内部贴上天空的图片
// 从里面看，就像真实的天空

// 创建天空盒网格
const skybox = BABYLON.MeshBuilder.CreateBox(
    "skyBox",                   // 名称
    { size: 1000 },             // 尺寸：1000个单位，非常大
    scene
);

// 创建天空盒材质
const skyboxMaterial = new BABYLON.StandardMaterial("skyBox", scene);

// 设置材质为背面渲染
// backFaceCulling：背面剔除
//   默认情况下，3D物体只渲染正面，背面不渲染（优化性能）
//   false = 不剔除背面，让我们能从立方体内部看到贴图
skyboxMaterial.backFaceCulling = false;

// 设置材质颜色
// 使用emissiveColor（自发光颜色）而不是diffuseColor
// 因为天空盒不需要受光照影响，自己会发光
skyboxMaterial.emissiveColor = new BABYLON.Color3(0.5, 0.7, 1.0);
//   淡蓝色，和背景色一致

// 禁用光照影响
// disableLighting：禁用光照
//   true = 天空盒不受场景光源影响
skyboxMaterial.disableLighting = true;

// 应用材质
skybox.material = skyboxMaterial;

console.log("天空盒创建成功:", skybox);

// ================================================================
// 调整立方体位置，让它在地面上方
// ================================================================

// 之前创建的box变量
// 设置Y轴位置为1，让它悬浮在地面上方
box.position.y = 1;
```

### 🚀 运行效果

保存文件，刷新浏览器（按F5），应该看到：
- ✅ 绿色的地面
- ✅ 淡蓝色的天空
- ✅ 立方体悬浮在地面上方

### ✅ 检查清单

- [ ] 看到绿色地面
- [ ] 看到蓝色天空
- [ ] 立方体在地面上方
- [ ] 可以旋转视角查看整个场景

### 🎓 知识点总结

1. **CreateGround**：创建平面地面
2. **Material（材质）**：控制物体外观
3. **diffuseColor**：物体的主要颜色
4. **emissiveColor**：自发光颜色（不受光照影响）
5. **skybox（天空盒）**：用大立方体模拟天空

### 🎯 下一步

完成任务2后，继续：
- ✅ 任务3：理解3D坐标系，移动立方体

---

## 📝 任务3-8：后续任务

由于篇幅限制，后续任务（任务3-8）的详细内容将在你完成前两个任务后逐步提供。

**任务3预览：** 理解3D坐标系，通过修改 `position` 属性移动立方体

**任务4预览：** 学习向量（Vector3）的加法、减法、长度计算

**任务5预览：** 学习旋转（rotation），让立方体旋转起来

---

## 💬 遇到问题怎么办？

1. **先看控制台**：按F12，查看红色错误信息
2. **对照代码**：仔细检查拼写、标点符号
3. **查看注释**：每行代码都有详细解释
4. **随时提问**：把错误信息发给我

---

## 🎉 完成任务1和2后的成就

恭喜你！你已经：
- ✅ 创建了第一个3D场景
- ✅ 理解了HTML、CSS、JavaScript的基本结构
- ✅ 学会了Babylon.js的基础用法
- ✅ 掌握了场景、相机、光源、网格的概念

**你已经迈出了飞行模拟器开发的第一步！** ✈️

继续保持每天30分钟的节奏，稳步前进！
